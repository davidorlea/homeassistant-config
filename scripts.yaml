sonos_play:
  alias: "Sonos Play Script"
  sequence:
    - service: media_player.sonos_snapshot
      data:
        entity_id:
          - media_player.sonos_device_wohnzimmer
          - media_player.sonos_device_kuche
    - service: media_player.sonos_unjoin
      data:
        entity_id:
          - media_player.sonos_device_wohnzimmer
          - media_player.sonos_device_kuche
    - service: media_player.sonos_join
      data:
        entity_id: media_player.sonos_device_kuche
        master: media_player.sonos_device_wohnzimmer
    - service: media_player.volume_set
      data_template:
        entity_id:
          - media_player.sonos_device_wohnzimmer
          - media_player.sonos_device_kuche
        volume_level: '{{ sonos_play_volume }}'
    - service: media_player.play_media
      data_template:
        entity_id: media_player.sonos_device_wohnzimmer
        media_content_id: '{{ sonos_play_media_id }}'
        media_content_type: '{{ sonos_play_media_type }}'
    - delay: '{{ sonos_play_delay }}'
    - service: media_player.sonos_restore
      data:
        entity_id:
          - media_player.sonos_device_wohnzimmer
          - media_player.sonos_device_kuche

sonos_say:
  alias: "Sonos TTS Script"
  sequence:
    - service: media_player.sonos_snapshot
      data:
        entity_id:
          - media_player.sonos_device_wohnzimmer
          - media_player.sonos_device_kuche
    - service: media_player.sonos_unjoin
      data:
        entity_id:
          - media_player.sonos_device_wohnzimmer
          - media_player.sonos_device_kuche
    - service: media_player.sonos_join
      data:
        entity_id: media_player.sonos_device_kuche
        master: media_player.sonos_device_wohnzimmer
    - service: media_player.volume_set
      data_template:
        entity_id:
          - media_player.sonos_device_wohnzimmer
          - media_player.sonos_device_kuche
        volume_level: '{{ sonos_say_volume }}'
    - service: tts.google_say
      data_template:
        entity_id: media_player.sonos_device_wohnzimmer
        message: '{{ sonos_say_message }}'
    - delay: '{{ sonos_say_delay }}'
    - service: media_player.sonos_restore
      data:
        entity_id:
          - media_player.sonos_device_wohnzimmer
          - media_player.sonos_device_kuche

dogbark:
  alias: Let the dogs out
  sequence:
    - service: script.sonos_play
      data_template:
        sonos_play_volume: '0.7'
        sonos_play_media_id: 'http://192.168.178.10:8123/local/sounds/dog_barking.mp3'
        sonos_play_media_type: 'audio/mp4'
        sonos_play_delay: '00:00:21'

alarm:
  alias: Ring the alarm
  sequence:
    - service: script.sonos_play
      data_template:
        sonos_play_volume: '0.5'
        sonos_play_media_id: 'http://192.168.178.10:8123/local/sounds/alarm_siren.mp3'
        sonos_play_media_type: 'audio/mp4'
        sonos_play_delay: '00:00:09'

ttstest:
  alias: Test the TTS
  sequence:
    - service: script.sonos_say
      data_template:
        sonos_say_volume: '0.5'
        sonos_say_message: 'Hallo, das ist ein Test.'
        sonos_say_delay: '00:00:03'

bedtime:
  alias: Go to bed
  sequence:
    - service: light.turn_on
      data:
        entity_id: group.hall_lights
    - delay: '00:10:00'
    - service: light.turn_off
      data:
        entity_id:
          - group.kitchen_lights
          - group.living_room_lights
    - delay: '00:30:00'
    - service: light.turn_off
      data:
        entity_id: group.hall_lights

occupancy_simulation_start:
  alias: Occupancy Simulation Start
  sequence:
    - service: scene.turn_on
      data_template:
        entity_id: 'scene.occupancy_simulation_{{ (range(1, 4) | random) }}'
    - service: script.turn_on
      data:
        entity_id: script.occupancy_simulation_loop

occupancy_simulation_stop:
  alias: Occupancy Simulation Stop
  sequence:
    - service: script.turn_off
      data:
        entity_id: script.occupancy_simulation_loop
    - service: scene.turn_on
      data:
        entity_id: 'scene.occupancy_simulation_0'

occupancy_simulation_loop:
  alias: Occupancy Simulation Loop
  sequence:
    - delay: '00:{{ (range(20, 41) | random) }}:00'
    - service: script.turn_on
      data:
        entity_id: script.occupancy_simulation_start
