sonos_play:
  alias: "Sonos Play Script"
  sequence:
    - service: media_player.sonos_snapshot
      data_template:
        entity_id: '{{ sonos_play_entity }}'
    - service: media_player.sonos_unjoin
      data_template:
        entity_id: '{{ sonos_play_entity }}'
    - service: media_player.volume_set
      data_template:
        entity_id: '{{ sonos_play_entity }}'
        volume_level: '{{ sonos_play_volume }}'
    - service: media_player.play_media
      data_template:
        entity_id: '{{ sonos_play_entity }}'
        media_content_id: '{{ sonos_play_media_id }}'
        media_content_type: '{{ sonos_play_media_type }}'
    - delay: '{{ sonos_play_delay }}'
    - service: media_player.sonos_restore
      data_template:
        entity_id: '{{ sonos_play_entity }}'

bedtime:
  alias: Go to bed
  sequence:
    - service: light.turn_on
      data:
        entity_id: group.hall_lights
    - delay: '00:10:00'
    - service: light.turn_off
      data:
        entity_id:
          - group.kitchen_lights
          - group.living_room_lights
    - delay: '00:30:00'
    - service: light.turn_off
      data:
        entity_id: group.hall_lights

occupancy_simulation_start:
  alias: Occupancy Simulation Start
  sequence:
    - service: scene.turn_on
      data_template:
        entity_id: 'scene.occupancy_simulation_{{ (range(1, 4) | random) }}'
    - service: script.turn_on
      data:
        entity_id: script.occupancy_simulation_loop

occupancy_simulation_stop:
  alias: Occupancy Simulation Stop
  sequence:
    - service: script.turn_off
      data:
        entity_id: script.occupancy_simulation_loop
    - service: scene.turn_on
      data:
        entity_id: 'scene.occupancy_simulation_0'

occupancy_simulation_loop:
  alias: Occupancy Simulation Loop
  sequence:
    - delay: '00:{{ (range(20, 41) | random) }}:00'
    - service: script.turn_on
      data:
        entity_id: script.occupancy_simulation_start
