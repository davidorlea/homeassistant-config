- platform: aseag_next_bus
  stop_id: 100621
  direction_id: 1

- platform: template
  sensors:
    next_bus_time:
      unit_of_measurement: min
      entity_id:
        - sensor.aseag_next_bus_100621_1
        - sensor.time
      value_template: >-
        {% set state = states("sensor.aseag_next_bus_100621_1") %}
        {% if state != "unknown" %}
          {{ ((as_timestamp(state) - as_timestamp(now())) / 60) | int }}
        {% else %}
          unknown
        {% endif %}
      icon_template: >-
        mdi:bus-clock
    next_bus_destination:
      entity_id:
        - sensor.aseag_next_bus_100621_1
        - sensor.time
      value_template: >-
        {% set destination = state_attr('sensor.aseag_next_bus_100621_1', 'destination') %}
        {% set line = state_attr('sensor.aseag_next_bus_100621_1', 'line') %}
        {% if destination != None and line != None %}
          {{ destination }} ({{ line }})
        {% else %}
          unknown
        {% endif %}
      icon_template: >-
        mdi:bus-clock

- platform: tankerkoenig
  api_key: !secret tankerkoenig_api_key
  fuel_type: 'diesel'

- platform: template
  sensors:
    gas_station_price:
      unit_of_measurement: â‚¬
      entity_id:
        - sensor.tankerkoenig
      value_template: >-
        {% set price = states('sensor.tankerkoenig') %}
        {% if price != "unknown" %}
          {{ price }}
        {% else %}
          unknown
        {% endif %}
      icon_template: >-
        mdi:gas-station
    gas_station_brand:
      entity_id:
        - sensor.tankerkoenig
      value_template: >-
        {% set brand = state_attr('sensor.tankerkoenig', 'brand') %}
        {% if brand != None %}
          {{ brand }}
        {% else %}
          unknown
        {% endif %}
      icon_template: >-
        mdi:gas-station
    gas_station_address:
      entity_id:
        - sensor.tankerkoenig
      value_template: >-
        {% set address = state_attr('sensor.tankerkoenig', 'address') %}
        {% if address != None %}
          {{ address }}
        {% else %}
          unknown
        {% endif %}
      icon_template: >-
        mdi:gas-station

- platform: voi_nearest_scooter

- platform: template
  sensors:
    nearest_scooter_distance:
      unit_of_measurement: min
      entity_id:
        - sensor.voi_nearest_scooter
      value_template: >-
        {% set state = states('sensor.voi_nearest_scooter') %}
        {% if state != "unknown" %}
          {{ ((state | float) * 1.4 / 60) | round(0) }}
        {% else %}
          unknown
        {% endif %}
      icon_template: >-
        mdi:scooter
    nearest_scooter_battery:
      unit_of_measurement: '%'
      entity_id:
        - sensor.voi_nearest_scooter
      value_template: >-
        {% set address = state_attr('sensor.voi_nearest_scooter', 'battery') %}
        {% if address != None %}
          {{ address }}
        {% else %}
          unknown
        {% endif %}
      icon_template: >-
        mdi:scooter
