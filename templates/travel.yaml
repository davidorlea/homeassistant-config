- sensor:
    - default_entity_id: sensor.next_bus_time
      unit_of_measurement: min
      state: >-
        {% if (states("sensor.aseag_next_bus_24236_h_1") | int(0)) >= 1 %}
          {% set departure = state_attr("sensor.aseag_next_bus_24236_h_1", "predictions")[0].departure %}
          {{ ((as_timestamp(departure) - as_timestamp(now())) / 60) | round(0) }}
        {% else %}
          None
        {% endif %}
      availability: "{{ has_value('sensor.aseag_next_bus_24236_h_1') }}"
      icon: mdi:bus-clock

- sensor:
    - default_entity_id: sensor.gas_station_price
      unit_of_measurement: â‚¬
      state: "{{ states('sensor.tankerkoenig') if has_value('sensor.tankerkoenig') else None }}"
      availability: "{{ has_value('sensor.tankerkoenig') }}"
      icon: mdi:gas-station

    - default_entity_id: sensor.gas_station_brand
      state: "{{ state_attr('sensor.tankerkoenig', 'brand') if has_value('sensor.tankerkoenig') else None }}"
      availability: "{{ has_value('sensor.tankerkoenig') }}"
      icon: mdi:gas-station

    - default_entity_id: sensor.gas_station_address
      state: "{{ state_attr('sensor.tankerkoenig', 'address') if has_value('sensor.tankerkoenig') else None }}"
      availability: "{{ has_value('sensor.tankerkoenig') }}"
      icon: mdi:gas-station

- sensor:
    - default_entity_id: sensor.nearest_scooter_distance
      unit_of_measurement: m
      state: "{{ states('sensor.tier_nearest_scooter') if has_value('sensor.tier_nearest_scooter') else None }}"
      availability: "{{ has_value('sensor.tier_nearest_scooter') }}"
      icon: mdi:scooter

    - default_entity_id: sensor.nearest_scooter_battery
      unit_of_measurement: '%'
      state: "{{ state_attr('sensor.tier_nearest_scooter', 'battery_level') if has_value('sensor.tier_nearest_scooter') else None }}"
      availability: "{{ has_value('sensor.tier_nearest_scooter') }}"
      icon: mdi:scooter
